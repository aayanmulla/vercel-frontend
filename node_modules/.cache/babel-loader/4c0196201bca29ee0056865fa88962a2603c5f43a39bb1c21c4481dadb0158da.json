{"ast":null,"code":"import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import\"./Signup.css\";import API_ENDPOINTS from\"../../apiEndpoints\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Signup=()=>{const[formData,setFormData]=useState({username:\"\",email:\"\",password:\"\",retypepassword:\"\"});const[otp,setOtp]=useState(\"\");const[showOtpField,setShowOtpField]=useState(false);const[error,setError]=useState(\"\");// const [emailVerified, setEmailVerified] = useState(false);\nconst navigate=useNavigate();const handleChange=e=>{const{name,value}=e.target;setFormData({...formData,[name]:value});};const handleSubmit=async e=>{e.preventDefault();// ✅ Password validation regex\nconst passwordRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;// ✅ Check if password meets the criteria\nif(!passwordRegex.test(formData.password)){alert(\"Password must be at least 8 characters long, include an uppercase letter, a lowercase letter, a number, and a special character.\");return;}// ✅ Check if passwords match\nif(formData.password!==formData.retypepassword){alert(\"Passwords do not match!\");return;}try{// Send OTP to email\nconst response=await axios.post(API_ENDPOINTS.SIGNUP,{username:formData.username,email:formData.email,password:formData.password,retypepassword:formData.retypepassword});if(response.status===200){alert(\"OTP sent to your email. Please verify.\");setShowOtpField(true);// Show OTP input field\n}}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.msg)||\"Signup failed.\");}};const handleVerifyOtp=async()=>{try{const response=await axios.post(API_ENDPOINTS.VERIFY_OTP,{email:formData.email,otp:otp,username:formData.username,password:formData.password});if(response.status===201){alert(\"Email verified successfully! Account created.\");// ✅ Get the first letter of the username\nconst firstLetter=formData.username.charAt(0).toUpperCase();// ✅ Assign profile image\nconst profileImageUrl=response.data.user.profileImage||`https://ui-avatars.com/api/?name=${firstLetter}&background=random&color=fff&size=128`;// ✅ Ensure user data is set properly\n// ✅ Store user data in localStorage\nconst userData={username:response.data.user.username,profileImage:profileImageUrl// ✅ Assign generated/returned profile image\n};localStorage.setItem(\"user\",JSON.stringify(userData));localStorage.setItem(\"token\",response.data.token);// ✅ Check if data is stored correctly\nconsole.log(\"Stored User:\",localStorage.getItem(\"user\"));// ✅ Notify other components of change\nwindow.dispatchEvent(new Event(\"storage\"));navigate(\"/bookings\");// Redirect after successful signup\n}}catch(error){var _error$response2,_error$response2$data;setError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.msg)||\"Invalid OTP. Try again.\");}};return/*#__PURE__*/_jsx(\"div\",{className:\"signup-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"signup-card\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"logo\",children:\"ParkEz\"}),/*#__PURE__*/_jsx(\"div\",{className:\"top-right-links\",children:/*#__PURE__*/_jsxs(\"span\",{children:[\"New User? \",/*#__PURE__*/_jsx(\"a\",{href:\"/login\",children:\"Login\"})]})}),/*#__PURE__*/_jsx(\"p\",{children:\"Register to continue\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"signup-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",placeholder:\"Full Name\",value:formData.username,onChange:handleChange,required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",placeholder:\"Email Id\",value:formData.email,onChange:handleChange,required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",placeholder:\"Enter Password\",value:formData.password,onChange:handleChange,required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"retypepassword\",placeholder:\"Confirm Password\",value:formData.retypepassword,onChange:handleChange,required:true})}),!showOtpField?/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"signup-button\",children:\"SIGN UP\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter OTP\",value:otp,onChange:e=>setOtp(e.target.value),required:true})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"signup-button\",onClick:handleVerifyOtp,children:\"Verify OTP\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-text\",children:error})]})]})});};export default Signup;","map":{"version":3,"names":["React","useState","useNavigate","axios","API_ENDPOINTS","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Signup","formData","setFormData","username","email","password","retypepassword","otp","setOtp","showOtpField","setShowOtpField","error","setError","navigate","handleChange","e","name","value","target","handleSubmit","preventDefault","passwordRegex","test","alert","response","post","SIGNUP","status","_error$response","_error$response$data","data","msg","handleVerifyOtp","VERIFY_OTP","firstLetter","charAt","toUpperCase","profileImageUrl","user","profileImage","userData","localStorage","setItem","JSON","stringify","token","console","log","getItem","window","dispatchEvent","Event","_error$response2","_error$response2$data","className","children","href","onSubmit","type","placeholder","onChange","required","onClick"],"sources":["/Users/karanpaigude/Desktop/Projects/Aayan Project/NewProject/ParkEz_Frontend/src/screens/Signup/Signup.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"./Signup.css\";\nimport API_ENDPOINTS from \"../../apiEndpoints\";\n\nconst Signup = () => {\n    const [formData, setFormData] = useState({\n        username: \"\",\n        email: \"\",\n        password: \"\",\n        retypepassword: \"\",\n    });\n\n    const [otp, setOtp] = useState(\"\");\n    const [showOtpField, setShowOtpField] = useState(false);\n    const [error, setError] = useState(\"\");\n    // const [emailVerified, setEmailVerified] = useState(false);\n\n    const navigate = useNavigate();\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setFormData({\n            ...formData,\n            [name]: value,\n        });\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n    \n        // ✅ Password validation regex\n        const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;\n    \n        // ✅ Check if password meets the criteria\n        if (!passwordRegex.test(formData.password)) {\n            alert(\"Password must be at least 8 characters long, include an uppercase letter, a lowercase letter, a number, and a special character.\");\n            return;\n        }\n    \n        // ✅ Check if passwords match\n        if (formData.password !== formData.retypepassword) {\n            alert(\"Passwords do not match!\");\n            return;\n        }\n    \n        try {\n            // Send OTP to email\n            const response = await axios.post(API_ENDPOINTS.SIGNUP, {\n                username: formData.username,\n                email: formData.email,\n                password: formData.password,\n                retypepassword: formData.retypepassword\n            });\n    \n            if (response.status === 200) {\n                alert(\"OTP sent to your email. Please verify.\");\n                setShowOtpField(true); // Show OTP input field\n            }\n        } catch (error) {\n            setError(error.response?.data?.msg || \"Signup failed.\");\n        }\n    };\n    \n\n    const handleVerifyOtp = async () => {\n        try {\n            const response = await axios.post(API_ENDPOINTS.VERIFY_OTP, {\n                email: formData.email,\n                otp: otp,\n                username: formData.username,\n                password: formData.password,\n            });\n    \n            if (response.status === 201) {\n                alert(\"Email verified successfully! Account created.\");\n                // ✅ Get the first letter of the username\n                const firstLetter = formData.username.charAt(0).toUpperCase();\n\n                // ✅ Assign profile image\n                const profileImageUrl = response.data.user.profileImage || \n                    `https://ui-avatars.com/api/?name=${firstLetter}&background=random&color=fff&size=128`;\n\n         \n                // ✅ Ensure user data is set properly\n                // ✅ Store user data in localStorage\n                const userData = {\n                    username: response.data.user.username,\n                    profileImage: profileImageUrl,  // ✅ Assign generated/returned profile image\n                };\n      \n                localStorage.setItem(\"user\", JSON.stringify(userData));\n                localStorage.setItem(\"token\", response.data.token);\n    \n                // ✅ Check if data is stored correctly\n                console.log(\"Stored User:\", localStorage.getItem(\"user\"));\n    \n                // ✅ Notify other components of change\n                window.dispatchEvent(new Event(\"storage\"));\n    \n                navigate(\"/bookings\"); // Redirect after successful signup\n            }\n        } catch (error) {\n            setError(error.response?.data?.msg || \"Invalid OTP. Try again.\");\n        }\n    };\n   \n    \n    \n    \n    return (\n        <div className=\"signup-container\">\n            <div className=\"signup-card\">\n                <h1 className=\"logo\">ParkEz</h1>\n                <div className=\"top-right-links\">\n                    <span>New User? <a href=\"/login\">Login</a></span>\n                </div>\n                <p>Register to continue</p>\n\n                <form className=\"signup-form\" onSubmit={handleSubmit}>\n                    <div className=\"input-group\">\n                        <input\n                            type=\"text\"\n                            name=\"username\"\n                            placeholder=\"Full Name\"\n                            value={formData.username}\n                            onChange={handleChange}\n                            required\n                        />\n                    </div>\n                    <div className=\"input-group\">\n                        <input\n                            type=\"email\"\n                            name=\"email\"\n                            placeholder=\"Email Id\"\n                            value={formData.email}\n                            onChange={handleChange}\n                            required\n                        />\n                    </div>\n                    <div className=\"input-group\">\n                        <input\n                            type=\"password\"\n                            name=\"password\"\n                            placeholder=\"Enter Password\"\n                            value={formData.password}\n                            onChange={handleChange}\n                            required\n                        />\n                    </div>\n                    <div className=\"input-group\">\n                        <input\n                            type=\"password\"\n                            name=\"retypepassword\"\n                            placeholder=\"Confirm Password\"\n                            value={formData.retypepassword}\n                            onChange={handleChange}\n                            required\n                        />\n                    </div>\n\n                    {!showOtpField ? (\n                        <button type=\"submit\" className=\"signup-button\">\n                            SIGN UP\n                        </button>\n                    ) : (\n                        <>\n                            <div className=\"input-group\">\n                                <input\n                                    type=\"text\"\n                                    placeholder=\"Enter OTP\"\n                                    value={otp}\n                                    onChange={(e) => setOtp(e.target.value)}\n                                    required\n                                />\n                            </div>\n                            <button type=\"button\" className=\"signup-button\" onClick={handleVerifyOtp}>\n                                Verify OTP\n                            </button>\n                        </>\n                    )}\n\n                    {error && <p className=\"error-text\">{error}</p>}\n                </form>\n            </div>\n        </div>\n    );\n};\n\nexport default Signup;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}